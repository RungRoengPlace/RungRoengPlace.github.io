import{c as g,r as l,b as d,j as e,a as x,d as w,S as n}from"./index-BLdxFrRq.js";import{P as u,T as k}from"./trash-Bcp4THCP.js";import{f as h,P as S,S as C}from"./format-cITwwtcr.js";const z=[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]],D=g("car",z);const I=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],E=g("clock",I),T=()=>{const[m,b]=l.useState([]),[f,p]=l.useState(!0),[r,o]=l.useState(!1),c={date:new Date().toISOString().split("T")[0],timeIn:h(new Date,"HH:mm"),timeOut:"",visitorName:"",plateNumber:"",houseNo:"",purpose:""},[t,a]=l.useState(c);l.useEffect(()=>{i()},[]);const i=async()=>{p(!0);try{const s=await d.getSecurityRecords();b(s)}catch(s){console.error(s)}p(!1)},j=async s=>{s.preventDefault(),n.showLoading();try{await d.saveSecurityRecord(t),n.fire({icon:"success",title:"บันทึกสำเร็จ",timer:1500,showConfirmButton:!1}),a({...c,date:t.date}),o(!1),i()}catch{n.fire("Error","เกิดข้อผิดพลาด","error")}},N=async s=>{if(!s)return;(await n.fire({title:"ยืนยันการลบ?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"ลบ"})).isConfirmed&&(await d.deleteSecurityRecord(s),i())},v=s=>{a(s),o(!0),window.scrollTo({top:0,behavior:"smooth"})};return f?e.jsx("div",{className:"p-8 text-center text-slate-400",children:"กำลังโหลดข้อมูล..."}):e.jsxs("div",{className:"space-y-6 animate-fade-in-up",children:[e.jsxs("div",{className:x("bg-white p-6 rounded-2xl shadow-lg border transition-colors",r?"border-amber-200 bg-amber-50/10":"border-orange-100"),children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-slate-800 flex items-center",children:[e.jsx("div",{className:x("p-2 rounded-lg mr-3 shadow-sm",r?"bg-amber-100 text-amber-600":"bg-orange-100 text-orange-600"),children:r?e.jsx(u,{size:20}):e.jsx(S,{size:20})}),r?"แก้ไขรายการ":"บันทึกผู้มาติดต่อ"]}),r&&e.jsx("button",{onClick:()=>{o(!1),a(c)},className:"text-sm text-red-500 hover:text-red-700 font-medium px-3 py-1 rounded-lg hover:bg-red-50",children:"ยกเลิก"})]}),e.jsxs("form",{onSubmit:j,className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"lg:col-span-2 grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase tracking-wider mb-2",children:"วันที่"}),e.jsx("input",{type:"date",value:t.date,onChange:s=>a({...t,date:s.target.value}),className:"w-full border-slate-200 rounded-xl p-3 bg-slate-50 focus:ring-2 focus:ring-orange-500 outline-none",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase tracking-wider mb-2",children:"เวลาเข้า/ออก"}),e.jsxs("div",{className:"flex bg-slate-50 rounded-xl border border-slate-200 overflow-hidden",children:[e.jsx("input",{type:"time",value:t.timeIn,onChange:s=>a({...t,timeIn:s.target.value}),className:"w-1/2 p-3 bg-transparent outline-none text-center border-r border-slate-200 focus:bg-orange-50",required:!0}),e.jsx("input",{type:"time",value:t.timeOut,onChange:s=>a({...t,timeOut:s.target.value}),className:"w-1/2 p-3 bg-transparent outline-none text-center focus:bg-orange-50"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase tracking-wider mb-2",children:"ทะเบียนรถ"}),e.jsxs("div",{className:"relative",children:[e.jsx(D,{size:18,className:"absolute left-3 top-3.5 text-slate-400"}),e.jsx("input",{type:"text",value:t.plateNumber,onChange:s=>a({...t,plateNumber:s.target.value}),className:"w-full border-slate-200 rounded-xl p-3 pl-10 bg-slate-50 focus:ring-2 focus:ring-orange-500 outline-none",placeholder:"เช่น 1กข-1234",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase tracking-wider mb-2",children:"ชื่อผู้ติดต่อ"}),e.jsxs("div",{className:"relative",children:[e.jsx(w,{size:18,className:"absolute left-3 top-3.5 text-slate-400"}),e.jsx("input",{type:"text",value:t.visitorName,onChange:s=>a({...t,visitorName:s.target.value}),className:"w-full border-slate-200 rounded-xl p-3 pl-10 bg-slate-50 focus:ring-2 focus:ring-orange-500 outline-none",placeholder:"ชื่อ-สกุล",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase tracking-wider mb-2",children:"ติดต่อบ้านเลขที่"}),e.jsx("input",{type:"text",value:t.houseNo,onChange:s=>a({...t,houseNo:s.target.value}),className:"w-full border-slate-200 rounded-xl p-3 bg-slate-50 focus:ring-2 focus:ring-orange-500 outline-none",placeholder:"เช่น 101/1",required:!0})]}),e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase tracking-wider mb-2",children:"วัตถุประสงค์ / หมายเหตุ"}),e.jsx("input",{type:"text",value:t.purpose,onChange:s=>a({...t,purpose:s.target.value}),className:"w-full border-slate-200 rounded-xl p-3 bg-slate-50 focus:ring-2 focus:ring-orange-500 outline-none",placeholder:"เช่น ส่งของ, ซ่อมไฟ"})]}),e.jsx("div",{className:"lg:col-span-1 flex items-end",children:e.jsx("button",{type:"submit",className:x("w-full h-[50px] flex items-center justify-center space-x-2 rounded-xl font-bold shadow-lg transition-all transform hover:scale-105 active:scale-95",r?"bg-amber-500 hover:bg-amber-600 text-white":"bg-orange-500 hover:bg-orange-600 text-white"),children:r?e.jsxs(e.Fragment,{children:[e.jsx(u,{size:18}),e.jsx("span",{children:"อัปเดต"})]}):e.jsxs(e.Fragment,{children:[e.jsx(C,{size:18}),e.jsx("span",{children:"บันทึก"})]})})})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden",children:[e.jsxs("div",{className:"p-4 bg-orange-50 border-b border-orange-100 font-bold text-orange-800 flex justify-between items-center",children:[e.jsxs("span",{children:[e.jsx("i",{className:"fa-solid fa-car-side mr-2"}),"ประวัติการเข้า-ออก"]}),e.jsx("span",{className:"text-xs font-normal text-orange-600",children:"แสดง 50 รายการล่าสุด"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-slate-50 text-slate-500 uppercase font-bold text-xs sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3",children:"วันที่/เวลา"}),e.jsx("th",{className:"px-4 py-3",children:"ทะเบียนรถ"}),e.jsx("th",{className:"px-4 py-3",children:"ผู้ติดต่อ"}),e.jsx("th",{className:"px-4 py-3",children:"บ้านเลขที่"}),e.jsx("th",{className:"px-4 py-3 text-center",children:"จัดการ"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100",children:m.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"text-center py-8 text-slate-400",children:"ไม่พบข้อมูล"})}):m.map(s=>e.jsxs("tr",{className:"hover:bg-orange-50/20 transition-colors group",children:[e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-bold text-slate-700",children:h(new Date(s.date),"dd/MM/yy")}),e.jsxs("div",{className:"text-xs text-slate-500 font-mono flex items-center mt-1",children:[e.jsx(E,{size:12,className:"mr-1"}),s.timeIn," - ",s.timeOut||"..."]})]}),e.jsx("td",{className:"px-4 py-3 font-mono text-slate-700 bg-slate-100 rounded px-2 w-fit h-fit",children:s.plateNumber}),e.jsxs("td",{className:"px-4 py-3 text-slate-600",children:[e.jsx("div",{children:s.visitorName}),e.jsx("div",{className:"text-xs text-slate-400 italic",children:s.purpose})]}),e.jsx("td",{className:"px-4 py-3 font-bold text-orange-600",children:s.houseNo}),e.jsxs("td",{className:"px-4 py-3 flex justify-center space-x-2 opacity-60 group-hover:opacity-100",children:[e.jsx("button",{onClick:()=>v(s),className:"text-amber-500 hover:text-amber-700 p-1",children:e.jsx(u,{size:16})}),e.jsx("button",{onClick:()=>N(s.rowIndex),className:"text-red-500 hover:text-red-700 p-1",children:e.jsx(k,{size:16})})]})]},s.rowIndex))})]})})]})]})};export{T as SecurityGuard};
