import{r as n,b as o,j as e,a as p,S as l}from"./index-DwUU5yaf.js";import{M as b}from"./types-CcqlWfqW.js";import{P as h,T as k}from"./trash-B5tv9Mf5.js";import{P as E,S as C,f as D}from"./format-Bw6PelTg.js";const F=()=>{const[g,f]=n.useState(null),[m,c]=n.useState([]),[j,u]=n.useState(!0),d={date:new Date().toISOString().split("T")[0],type:"ค่าไฟฟ้าส่วนกลาง",month:b[new Date().getMonth()],details:"",amount:0,note:"-"},[s,a]=n.useState(d),[r,x]=n.useState(!1);n.useEffect(()=>{w()},[]);const w=async()=>{u(!0);const[t,i]=await Promise.all([o.getDropdownData(),o.getExpenses(50)]);f(t),c(i),u(!1)},v=async t=>{if(t.preventDefault(),!s.amount){l.fire("ข้อมูลไม่ครบถ้วน","กรุณาระบุจำนวนเงิน","warning");return}l.showLoading();try{await o.saveExpense(s),l.fire({icon:"success",title:"บันทึกสำเร็จ",timer:1500,showConfirmButton:!1}),r?(a(d),x(!1)):a(d);const i=await o.getExpenses(50);c(i)}catch{l.fire("Error","เกิดข้อผิดพลาดในการบันทึก","error")}},N=t=>{a(t),x(!0),window.scrollTo({top:0,behavior:"smooth"})},y=async t=>{if(!t)return;if((await l.fire({title:"ยืนยันการลบ?",text:"ข้อมูลนี้จะถูกลบถาวร",icon:"warning",showCancelButton:!0})).isConfirmed){l.showLoading(),await o.deleteExpense(t),l.close();const S=await o.getExpenses(50);c(S)}};return j?e.jsx("div",{className:"p-8 text-center text-slate-400",children:"กำลังโหลดข้อมูล..."}):e.jsxs("div",{className:"space-y-6 animate-fade-in-up",children:[e.jsxs("div",{className:p("bg-white p-6 rounded-2xl shadow-lg border transition-colors",r?"border-amber-200 bg-amber-50/10":"border-red-100"),children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-slate-800 flex items-center",children:[e.jsx("div",{className:p("p-2 rounded-lg mr-3 shadow-sm",r?"bg-amber-100 text-amber-600":"bg-red-100 text-red-600"),children:r?e.jsx(h,{size:20}):e.jsx(E,{size:20})}),r?"แก้ไขรายการจ่าย":"บันทึกรายจ่ายใหม่"]}),r&&e.jsx("button",{onClick:()=>{x(!1),a(d)},className:"text-sm text-red-500 hover:text-red-700 font-medium px-3 py-1 rounded-lg hover:bg-red-50",children:"ยกเลิกการแก้ไข"})]}),e.jsxs("form",{onSubmit:v,className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase tracking-wider mb-2",children:"วันที่"}),e.jsx("input",{type:"date",value:s.date,onChange:t=>a({...s,date:t.target.value}),className:"w-full border-slate-200 rounded-xl p-3 bg-slate-50 focus:ring-2 focus:ring-red-500 outline-none transition-shadow",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase tracking-wider mb-2",children:"ประจำเดือน"}),e.jsx("select",{value:s.month,onChange:t=>a({...s,month:t.target.value}),className:"w-full border-slate-200 rounded-xl p-3 bg-slate-50 focus:ring-2 focus:ring-red-500 outline-none transition-shadow",children:b.map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase tracking-wider mb-2",children:"ประเภทรายจ่าย"}),e.jsx("select",{value:s.type,onChange:t=>a({...s,type:t.target.value}),className:"w-full border-slate-200 rounded-xl p-3 bg-slate-50 focus:ring-2 focus:ring-red-500 outline-none transition-shadow",children:g?.expenseTypes.map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase tracking-wider mb-2",children:"รายละเอียด"}),e.jsx("input",{type:"text",value:s.details,onChange:t=>a({...s,details:t.target.value}),className:"w-full border-slate-200 rounded-xl p-3 bg-slate-50 focus:ring-2 focus:ring-red-500 outline-none transition-shadow",placeholder:"เช่น เดือน ม.ค."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase tracking-wider mb-2",children:"จำนวนเงิน"}),e.jsx("input",{type:"number",step:"0.01",value:s.amount,onChange:t=>a({...s,amount:Number(t.target.value)}),className:"w-full border-slate-200 rounded-xl p-3 bg-slate-50 focus:ring-2 focus:ring-red-500 outline-none text-right font-mono font-bold text-lg text-red-600",required:!0,min:"0"})]}),e.jsxs("div",{className:"lg:col-span-3",children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase tracking-wider mb-2",children:"หมายเหตุ"}),e.jsx("input",{type:"text",value:s.note,onChange:t=>a({...s,note:t.target.value}),className:"w-full border-slate-200 rounded-xl p-3 bg-slate-50 focus:ring-2 focus:ring-red-500 outline-none transition-shadow",placeholder:"-"})]}),e.jsx("div",{className:"lg:col-span-4 flex justify-end mt-4",children:e.jsx("button",{type:"submit",className:p("flex items-center space-x-2 px-8 py-3 rounded-xl font-bold shadow-lg transition-all transform hover:scale-105 active:scale-95",r?"bg-amber-500 hover:bg-amber-600 text-white shadow-amber-200":"bg-red-500 hover:bg-red-600 text-white shadow-red-200"),children:r?e.jsxs(e.Fragment,{children:[e.jsx(h,{size:18}),e.jsx("span",{children:"อัปเดตข้อมูล"})]}):e.jsxs(e.Fragment,{children:[e.jsx(C,{size:18}),e.jsx("span",{children:"บันทึกรายจ่าย"})]})})})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden",children:[e.jsxs("div",{className:"p-4 bg-slate-50 border-b border-slate-100 font-bold text-slate-600 flex justify-between items-center",children:[e.jsx("span",{children:"ประวัติรายการล่าสุด"}),e.jsx("span",{className:"text-xs font-normal text-slate-400",children:"แสดง 50 รายการล่าสุด"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-slate-50 text-slate-500 uppercase font-bold text-xs sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 whitespace-nowrap",children:"วันที่"}),e.jsx("th",{className:"px-6 py-3 whitespace-nowrap",children:"ประเภท"}),e.jsx("th",{className:"px-6 py-3 whitespace-nowrap",children:"รายละเอียด"}),e.jsx("th",{className:"px-6 py-3 text-right whitespace-nowrap",children:"จำนวนเงิน"}),e.jsx("th",{className:"px-6 py-3 whitespace-nowrap",children:"หมายเหตุ"}),e.jsx("th",{className:"px-6 py-3 text-center whitespace-nowrap",children:"จัดการ"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100",children:m.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"text-center py-8 text-slate-400",children:"ไม่พบข้อมูลบันทึกรายจ่าย"})}):m.map(t=>e.jsxs("tr",{className:"hover:bg-slate-50 transition-colors group",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-slate-600 font-mono text-xs",children:D(new Date(t.date),"dd/MM/yyyy")}),e.jsx("td",{className:"px-6 py-4 font-medium text-slate-700",children:t.type}),e.jsx("td",{className:"px-6 py-4 text-slate-500",children:t.details}),e.jsx("td",{className:"px-6 py-4 text-right font-bold text-red-500 font-mono",children:t.amount.toLocaleString()}),e.jsx("td",{className:"px-6 py-4 text-slate-500 max-w-xs truncate",children:t.note}),e.jsxs("td",{className:"px-6 py-4 flex justify-center space-x-3 opacity-60 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>N(t),className:"text-amber-400 hover:text-amber-600 p-1 hover:bg-amber-50 rounded",children:e.jsx(h,{size:16})}),e.jsx("button",{onClick:()=>y(t.rowIndex),className:"text-red-400 hover:text-red-600 p-1 hover:bg-red-50 rounded",children:e.jsx(k,{size:16})})]})]},t.rowIndex))})]})})]})]})};export{F as Expense};
